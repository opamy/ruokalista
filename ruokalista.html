<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; min-height: 15.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="fi"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;Viikon Ruokalista&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>* { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif }</p>
<p class="p1"><span class="Apple-converted-space">    </span>.editable {</p>
<p class="p1"><span class="Apple-converted-space">      </span>min-height: 40px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 8px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 6px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border: 1px solid #e5e7eb;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #f9fafb;</p>
<p class="p1"><span class="Apple-converted-space">      </span>transition: all 0.2s;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .editable {</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: #374151;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #1f2937;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #f3f4f6;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.editable:focus {</p>
<p class="p1"><span class="Apple-converted-space">      </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-color: #5D5CDE;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .editable:focus {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #111827;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.editable:empty:before {</p>
<p class="p1"><span class="Apple-converted-space">      </span>content: attr(data-placeholder);</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #9ca3af;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .editable:empty:before {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #6b7280;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.readonly {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #f3f4f6 !important;</p>
<p class="p1"><span class="Apple-converted-space">      </span>cursor: not-allowed;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.dark .readonly {</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #374151 !important;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.loading {</p>
<p class="p1"><span class="Apple-converted-space">      </span>opacity: 0.6;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="min-h-screen p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="max-w-4xl mx-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="text-center mb-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-2"&gt;Viikon Ruokalista&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p class="text-gray-600 dark:text-gray-400"&gt;Arkipäivät • &lt;span id="updateStatus"&gt;Ladataan tietoja...&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="space-y-6" id="ruokaviikko"&gt;&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div class="mt-8 text-center space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex flex-wrap justify-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="paivita" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors"&gt;🔄 Päivitä tiedot&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="kopioi" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors"&gt;📋 Kopioi sisältö&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button id="tulosta" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors"&gt;🖨️ Tulosta&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p class="text-sm text-gray-500 dark:text-gray-400"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>💡 Tiedot päivittyvät automaattisesti Google Sheetsistä. Klikkaa "Päivitä tiedot" saadaksesi uusimmat tiedot.</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// ============ KONFIGURAATIO - VAIHDA TÄMÄ OMAAN SHEETS-LINKKIISI ============</p>
<p class="p1"><span class="Apple-converted-space">    </span>const GOOGLE_SHEETS_URL = '<a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vRuJ42x7lep6sVX5NmlCWwghH-chQv9hDWZ6TVOTKLtcFrDxxSSr0TSN5GPKz6q5m9tkNxCzPi5NAzo/pub?gid=0&amp;single=true&amp;output=csv">https://docs.google.com/spreadsheets/d/e/2PACX-1vRuJ42x7lep6sVX5NmlCWwghH-chQv9hDWZ6TVOTKLtcFrDxxSSr0TSN5GPKz6q5m9tkNxCzPi5NAzo/pub?gid=0&amp;single=true&amp;output=csv</a>';</p>
<p class="p1"><span class="Apple-converted-space">    </span>// ========================================================================</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Tumma tila automaattisesti</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.documentElement.classList.add('dark');</p>
<p class="p1"><span class="Apple-converted-space">    </span>window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.documentElement.classList.toggle('dark', e.matches);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Päivien ja kenttien määrittely</p>
<p class="p1"><span class="Apple-converted-space">    </span>const days = [</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ name: "Maanantai" },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ name: "Tiistai" },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ name: "Keskiviikko" },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ name: "Torstai" },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ name: "Perjantai" }</p>
<p class="p1"><span class="Apple-converted-space">    </span>];</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>const fields = [</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ key: "ruoka", label: "Ruoka", placeholder: "Ladataan..." },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ key: "kokki”, label: "Kuka tekee", placeholder: "Ladataan..." },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ key: "tarvikkeet", label: "Tarvikkeet", placeholder: "Ladataan..." },</p>
<p class="p1"><span class="Apple-converted-space">      </span>{ key: "ohjeet", label: "Ohjeet", placeholder: "Ladataan..." }</p>
<p class="p1"><span class="Apple-converted-space">    </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Renderöi kentät</p>
<p class="p1"><span class="Apple-converted-space">    </span>function renderDays() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>let html = "";</p>
<p class="p1"><span class="Apple-converted-space">      </span>days.forEach((day, dayIndex) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>html += `&lt;div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h2 class="text-2xl font-semibold mb-4 text-gray-900 dark:text-white"&gt;${day.name}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="grid md:grid-cols-2 gap-6"&gt;`;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>fields.slice(0,2).forEach((field) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">          </span>html += `&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"&gt;${field.label}&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="editable readonly text-base"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-day="${dayIndex}"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-field="${field.key}"</p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-placeholder="${field.placeholder}"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>html += `&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"&gt;${fields[2].label}&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="editable readonly text-base"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-day="${dayIndex}"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-field="${fields[2].key}"</p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-placeholder="${fields[2].placeholder}"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div class="mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"&gt;${fields[3].label}&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="editable readonly text-base min-h-20"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-day="${dayIndex}"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-field="${fields[3].key}"</p>
<p class="p1"><span class="Apple-converted-space">                 </span>data-placeholder="${fields[3].placeholder}"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('ruokaviikko').innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Poimi Spreadsheet ID URL:sta</p>
<p class="p1"><span class="Apple-converted-space">    </span>function extractSpreadsheetId(url) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const match = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);</p>
<p class="p1"><span class="Apple-converted-space">      </span>return match ? match[1] : null;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Yksinkertainen CSV-parseri</p>
<p class="p1"><span class="Apple-converted-space">    </span>function parseCSV(csvText) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const lines = csvText.trim().split('\n');</p>
<p class="p1"><span class="Apple-converted-space">      </span>return lines.map(line =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const result = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>let current = '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>let inQuotes = false;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>for (let i = 0; i &lt; line.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>const char = line[i];</p>
<p class="p1"><span class="Apple-converted-space">          </span>if (char === '"') {</p>
<p class="p1"><span class="Apple-converted-space">            </span>inQuotes = !inQuotes;</p>
<p class="p1"><span class="Apple-converted-space">          </span>} else if (char === ',' &amp;&amp; !inQuotes) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>result.push(current.trim().replace(/^"|"$/g, ''));</p>
<p class="p1"><span class="Apple-converted-space">            </span>current = '';</p>
<p class="p1"><span class="Apple-converted-space">          </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">            </span>current += char;</p>
<p class="p1"><span class="Apple-converted-space">          </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>result.push(current.trim().replace(/^"|"$/g, ''));</p>
<p class="p1"><span class="Apple-converted-space">        </span>return result;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Päivitä yksittäinen kenttä</p>
<p class="p1"><span class="Apple-converted-space">    </span>function updateField(dayIndex, fieldKey, value) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const element = document.querySelector(`[data-day="${dayIndex}"][data-field="${fieldKey}"]`);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (element) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>element.textContent = value || '';</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Täytä kentät Sheets-datalla</p>
<p class="p1"><span class="Apple-converted-space">    </span>function populateFields(sheetData) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Tyhjennä ensin kaikki kentät</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.querySelectorAll('.editable').forEach(el =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>el.textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Oletetaan että data on muodossa:</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Rivi 0: [Päivä, Ruoka, Kuka, Tarvikkeet, Ohjeet] (otsikot - ohitetaan)</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Rivi 1: [Maanantai, Spagetti, Äiti, Pasta;Jauheliha, Keitä pasta...]</p>
<p class="p1"><span class="Apple-converted-space">      </span>// jne.</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>sheetData.forEach((row, rowIndex) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (rowIndex === 0) return; // Ohita otsikkorivi</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const dayIndex = rowIndex - 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (dayIndex &gt;= 5) return; // Vain 5 päivää</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const [dayName, ruoka, kuka, tarvikkeet, ohjeet] = row;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Päivitä kentät</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateField(dayIndex, 'ruoka', ruoka);</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateField(dayIndex, 'kuka', kuka);</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateField(dayIndex, 'tarvikkeet', tarvikkeet);</p>
<p class="p1"><span class="Apple-converted-space">        </span>updateField(dayIndex, 'ohjeet', ohjeet);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Lataa tiedot Google Sheetsistä</p>
<p class="p1"><span class="Apple-converted-space">    </span>async function loadData() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const statusEl = document.getElementById('updateStatus');</p>
<p class="p1"><span class="Apple-converted-space">      </span>const container = document.getElementById('ruokaviikko');</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>statusEl.textContent = 'Ladataan tietoja...';</p>
<p class="p1"><span class="Apple-converted-space">      </span>statusEl.className = 'text-blue-500';</p>
<p class="p1"><span class="Apple-converted-space">      </span>container.classList.add('loading');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>try {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const spreadsheetId = extractSpreadsheetId(GOOGLE_SHEETS_URL);</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!spreadsheetId) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>throw new Error('Virheellinen Google Sheets URL');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Käytä CSV-exporttia</p>
<p class="p1"><span class="Apple-converted-space">        </span>const csvUrl = `https://docs.google.com/spreadsheets/d/${spreadsheetId}/export?format=csv&amp;gid=0`;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const response = await fetch(csvUrl);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>if (!response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>throw new Error(`Dokumentti ei ole julkinen tai sitä ei löydy (${response.status})`);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const csvData = await response.text();</p>
<p class="p1"><span class="Apple-converted-space">        </span>const rows = parseCSV(csvData);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>if (rows.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">          </span>populateFields(rows);</p>
<p class="p1"><span class="Apple-converted-space">          </span>const now = new Date().toLocaleTimeString('fi-FI');</p>
<p class="p1"><span class="Apple-converted-space">          </span>statusEl.textContent = `Päivitetty ${now}`;</p>
<p class="p1"><span class="Apple-converted-space">          </span>statusEl.className = 'text-green-500';</p>
<p class="p1"><span class="Apple-converted-space">        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">          </span>statusEl.textContent = 'Ei dataa löytynyt';</p>
<p class="p1"><span class="Apple-converted-space">          </span>statusEl.className = 'text-orange-500';</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>console.error('Virhe ladattaessa dataa:', error);</p>
<p class="p1"><span class="Apple-converted-space">        </span>statusEl.textContent = `Virhe: ${error.message}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>statusEl.className = 'text-red-500';</p>
<p class="p1"><span class="Apple-converted-space">      </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">        </span>container.classList.remove('loading');</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Event listeners</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('paivita').addEventListener('click', loadData);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Kopioi</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('kopioi').onclick = function() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>let output = 'VIIKON RUOKALISTA\n\n';</p>
<p class="p1"><span class="Apple-converted-space">      </span>const dayBlocks = document.querySelectorAll('.bg-gray-50, .dark\\:bg-gray-800');</p>
<p class="p1"><span class="Apple-converted-space">      </span>Array.from(dayBlocks).forEach((block) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const day = block.querySelector('h2').textContent;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const [ruoka, kuka, tarvikkeet, ohjeet] = block.querySelectorAll('.editable');</p>
<p class="p1"><span class="Apple-converted-space">        </span>output += `${day.toUpperCase()}\nRuoka: ${ruoka.textContent.trim()}\nKuka tekee: ${kuka.textContent.trim()}\nTarvikkeet: ${tarvikkeet.textContent.trim()}\nOhjeet: ${ohjeet.textContent.trim()}\n\n`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>navigator.clipboard.writeText(output).then(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>showToast('Ruokalista kopioitu leikepöydälle!');</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Tyhjennä kaikki</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('tyhjenna').onclick = function() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (!confirm('Haluatko varmasti tyhjentää näytön? (Tämä ei muuta Google Sheetsiä)')) return;</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.querySelectorAll('.editable').forEach(el =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>el.textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('updateStatus').textContent = 'Näyttö tyhjennetty';</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById('updateStatus').className = 'text-gray-500';</p>
<p class="p1"><span class="Apple-converted-space">      </span>showToast('Näyttö tyhjennetty!');</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Tulosta</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.getElementById('tulosta').onclick = function() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>window.print();</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Toast</p>
<p class="p1"><span class="Apple-converted-space">    </span>function showToast(message) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const toast = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">      </span>toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300';</p>
<p class="p1"><span class="Apple-converted-space">      </span>toast.textContent = message;</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.body.appendChild(toast);</p>
<p class="p1"><span class="Apple-converted-space">      </span>setTimeout(() =&gt; {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>toast.style.transform = 'translateX(400px)';<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>setTimeout(() =&gt; toast.remove(), 300);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>}, 2000);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Alusta sivu</p>
<p class="p1"><span class="Apple-converted-space">    </span>renderDays();</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Lataa tiedot heti sivun latautuessa</p>
<p class="p1"><span class="Apple-converted-space">    </span>loadData();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Päivitä tiedot automaattisesti 5 minuutin välein (valinnainen)</p>
<p class="p1"><span class="Apple-converted-space">    </span>setInterval(loadData, 5 * 60 * 1000); // 5 minuuttia</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
